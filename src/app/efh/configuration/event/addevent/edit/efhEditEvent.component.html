<div class="section">
  <form [formGroup]="eventForm" (ngSubmit)="onSubmit()">
    <div class="row pb-3">
      <div class="col">
        <p class="section_titulo_0">{{titulo}}</p>
      </div>
    </div>
    <div class="row pb-3">
      <div class="col">
        <div class="d-flex justify-content-end">
          <button type="submit" class="btn"
                  [ngClass]="{'myblue': globalService.aguila,'myorange': !globalService.aguila}"
                  [disabled]="disabledSave" *ngIf="accion != 'ver'">
            <i class="ti-pencil"></i>
            Guardar / Actualizar
          </button>
          <button type="button" class="btn"
                  [ngClass]="{'myblue': globalService.aguila,'myorange': !globalService.aguila}"
                  (click)="regresar()">
            <i class="ti-angle-double-left"></i>
            Regresar
          </button>
        </div>
      </div>
    </div>
    <div class="row"> <!-- Combos encabezado -->
      <div class="col-md-3">
        <div class="form-group">
          <small class="form-text text-muted text-left">Tipo de Evento:</small>
          <mat-select class="form-control" formControlName="eventTypeControl" (selectionChange)="enableControls($event)" [(value)]="selectedEventType">
            <mat-option class="form-control" [value]="event.id" *ngFor="let event of eventTypesArr">{{event.name}}</mat-option>
          </mat-select>
        </div>
      </div>
      <div class="col-md-3">
        <div class="form-group">
          <small class="form-text text-muted text-left">Unidad:</small>
          <mat-select class="form-control" formControlName="unitControl" [(value)]="selectedUnit">
            <mat-option class="form-control" [value]="unit.id" *ngFor="let unit of unitsArr">{{unit.name}}</mat-option>
          </mat-select>
        </div>
      </div>
      <div class="col-md-3">
        <div class="form-group">
          <small class="form-text text-muted text-left">Tipo de combustible:</small>
          <mat-select class="form-control" formControlName="fuelTypeControl" [(value)]="selectedFuelType">
            <mat-option class="form-control" [value]="fuel.id" *ngFor="let fuel of fuelTypesArr">{{fuel.name}}</mat-option>
          </mat-select>
        </div>
      </div>

    </div>
    <br/>
    <div style="border-style: groove; padding: 2%" *ngIf="isShotSectionVisible"><!-- Section Disparo -->
      <div class="row">
        <div class="col">
          <label class="custom-font">Disparo</label>
          <br/>
        </div>
      </div>
      <div class="row">
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Fecha Pérdida de Flama (Flame Off):</small>
            <input type="date" class="form-control" formControlName="flameOffDateShot"/>
          </div>
          <div *ngIf="submittedData && isShotSectionVisible && f.flameOffDateShot.errors" style="color:red">
            <div *ngIf="f.flameOffDateShot.errors.required">Requerido</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Hora Pérdida de Flama (Flame Off):</small>
            <input type="time" class="form-control" min="00:00:00" max="23:59:59" formControlName="flameOffTimeShot" step="1"/>
          </div>
          <div *ngIf="submittedData && isShotSectionVisible && f.flameOffTimeShot.errors" style="color:red">
            <div *ngIf="f.flameOffTimeShot.errors.required">Requerido</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Fecha Velocidad Plena sin Carga (FSNL):</small>
            <input type="date" class="form-control" type="date" formControlName="fsnlDateShot"/>
          </div>
          <div *ngIf="submittedData && isShotSectionVisible && f.fsnlDateShot.errors" style="color:red">
            <div *ngIf="f.fsnlDateShot.errors.required">Requerido</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Hora Velocidad Plena sin Carga (FSNL):</small>
            <input class="form-control" type="time" min="00:00:00" max="23:59:59" formControlName="fsnlTimeShot" step="1"/>
          </div>
          <div *ngIf="submittedData && isShotSectionVisible && f.fsnlTimeShot.errors" style="color:red">
            <div *ngIf="f.fsnlTimeShot.errors.required">Requerido</div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Carga antes del disparo(MW):</small>
            <input class="form-control" type="text" formControlName="chargeShot"/>
          </div>
          <div *ngIf="submittedData && isShotSectionVisible && f.chargeShot.errors" style="color:red">
            <div *ngIf="f.chargeShot.errors.required">Requerido</div>
          </div>
        </div>
      </div>
    </div>
    <div style="border-style: groove; padding: 2%" *ngIf="isRejectSectionVisible"><!-- Section Rechazo Carga -->
      <div class="row">
        <div class="col">
          <label class="custom-font">Rechazo de Carga</label>
          <br/>
        </div>
      </div>
      <div class="row">
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Fecha Rechazo de Carga:</small>
            <input class="form-control" type="date" formControlName="dateReject"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Hora Rechazo de Carga:</small>
            <input class="form-control" type="time" min="00:00:00" max="23:59:59" step="1" formControlName="timeReject"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Carga antes del rechazo(MW):</small>
            <input class="form-control" type="text" formControlName="chargeReject"/>
          </div>
          <div *ngIf="submittedData && isRejectSectionVisible && f.chargeReject.errors" style="color:red">
            <div *ngIf="f.chargeReject.errors.required">Requerido</div>
          </div>
        </div>
      </div>
    </div>
    <div style="border-style: groove; padding: 2%" *ngIf="isRunbackSectionVisible"><!-- Section Runback -->
      <div class="row">
        <div class="col">
          <label class="custom-font">Runback</label>
          <br/>
        </div>
      </div>
      <div class="row">
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Fecha Inicio del runback:</small>
            <input class="form-control" type="date" formControlName="startDateRunback"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Hora Inicio del runback:</small>
            <input class="form-control" type="time" min="00:00:00" max="23:59:59" step="1" formControlName="startTimeRunback"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Fecha Fin del runback:</small>
            <input class="form-control" type="date" formControlName="endDateRunback"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Hora Fin del runback:</small>
            <input class="form-control" type="time" min="00:00:00" max="23:59:59" step="1" formControlName="endTimeRunback"/>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Carga antes del runback(MW):</small>
            <input class="form-control" type="text" formControlName="chargeBeforeRunback"/>
          </div>
          <div *ngIf="submittedData && isRunbackSectionVisible && f.chargeBeforeRunback.errors" style="color:red">
            <div *ngIf="f.chargeBeforeRunback.errors.required">Requerido</div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Carga después del runback(MW):</small>
            <input class="form-control" type="text" formControlName="chargeAfterRunback"/>
          </div>
          <div *ngIf="submittedData && isRunbackSectionVisible && f.chargeAfterRunback.errors" style="color:red">
            <div *ngIf="f.chargeAfterRunback.errors.required">Requerido</div>
          </div>
        </div>
      </div>
    </div>
    <div style="border-style: groove; padding: 2%" *ngIf="isStopSectionVisible"><!-- Section Paro -->
      <div class="row">
        <div class="col">
          <label class="custom-font">Paro</label>
          <br/>
        </div>
      </div>
      <div class="row">
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Fecha Pérdida de Flama (Flame Off):</small>
            <input class="form-control" type="date" formControlName="flameOffDateStop"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Hora Pérdida de Flama (Flame Off):</small>
            <input class="form-control" type="time" min="00:00:00" max="23:59:59" step="1" formControlName="flameOffTimeStop"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Fecha Velocidad Plena sin Carga (FSNL):</small>
            <input class="form-control" type="date" formControlName="fsnlDateStop"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Hora Velocidad Plena sin Carga (FSNL):</small>
            <input class="form-control" type="time" min="00:00:00" max="23:59:59" step="1" formControlName="fsnlTimeStop"/>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Carga antes del paro(MW):</small>
            <input class="form-control" type="text" formControlName="chargeStop"/>
          </div>
          <div *ngIf="submittedData && isStopSectionVisible && f.chargeStop.errors" style="color:red">
            <div *ngIf="f.chargeStop.errors.required">Requerido</div>
          </div>
        </div>
      </div>
    </div>
    <div style="border-style: groove; padding: 2%" *ngIf="isDieselSectionVisible"><!-- Section Diesel -->
      <div class="row">
        <div class="col">
          <label class="custom-font">Operación en Diesel</label>
          <br/>
        </div>
      </div>
      <div class="row">
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Fecha Inicio Operación en Diesel:</small>
            <input class="form-control" type="date" formControlName="startDateDiesel"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Hora Inicio Operación en Diesel:</small>
            <input class="form-control" type="time" min="00:00:00" max="23:59:59" step="1" formControlName="startTimeDiesel"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Fecha Fin Operación en Diesel:</small>
            <input class="form-control" type="date" formControlName="endDateDiesel"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Hora Fin Operación en Diesel:</small>
            <input class="form-control" type="time" min="00:00:00" max="23:59:59" step="1" formControlName="endTimeDiesel"/>
          </div>
        </div>
      </div>
    </div>
    <div style="border-style: groove; padding: 2%" *ngIf="isNormalOperationSectionVisible"><!-- Section Normal Operation -->
      <div class="row">
        <div class="col">
          <label class="custom-font">Operación Normal</label>
          <br/>
        </div>
      </div>
      <div class="row">
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Fecha Inicio Operación Normal:</small>
            <input class="form-control" type="date" formControlName="startDateNormal"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Hora Inicio Operación Normal:</small>
            <input class="form-control" type="time" min="00:00:00" max="23:59:59" step="1" formControlName="startTimeNormal"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Fecha Fin Operación Normal:</small>
            <input class="form-control" type="date" formControlName="endDateNormal"/>
          </div>
        </div>
        <div class="col-md-3">
          <div class="form-group">
            <small class="form-text text-muted" >Hora Fin Operación Normal:</small>
            <input class="form-control" type="time" min="00:00:00" max="23:59:59" step="1" formControlName="endTimeNormal"/>
          </div>
        </div>
      </div>
    </div>
    <br/>
    <div *ngIf="isDefaultSectionsVisible">
      <div class="col-md-12">
        <div class="form-group">
          <small class="form-text text-muted">Descripción:</small>
          <textarea rows="4" style="width: 100%" formControlName="description" (keydown)="enableSaveButton();"></textarea>
        </div>
        <div *ngIf="submittedData && f.description.errors" style="color:red">
          <div *ngIf="f.description.errors.required">Requerido</div>
        </div>
      </div>
      <!-- Aqui van la sección de observaciones -->
      <div class="col-md-12">
        <div class="form-group">
          <small class="form-text text-muted">Observación:</small>
          <textarea rows="4" style="width: 100%" formControlName="observations" (keydown)="enableSaveButton();"></textarea>
        </div>
        <div *ngIf="submittedData && f.observations.errors" style="color:red">
          <div *ngIf="f.observations.errors.required">Requerido</div>
        </div>
        <div class="row justify-content-end mb-5">
          <div class="col-md-auto">
            <button type="button" (click)="addObservation();" class="btn" [disabled]="isAddObvsDisabled">
              <i class="ti-bookmark-alt"></i>&nbsp;
              Agregar observación
            </button>
          </div>
        </div>
        <!-- Lista de observaciones -->
        <div class="row">
          <div class="col">
            <div class="mat-elevation-z0">
              <table mdbTable class="table_catalogo">
                <thead>
                <tr>
                  <th *ngFor="let head of headObservaciones" scope="col">{{head}} </th>
                </tr>
                </thead>
                <tbody>
                <tr mdbTableCol *ngFor="let el of observationsArr; let i = index;">
                  <th scope="row">{{i+1}}</th>
                  <td>{{el.nombre}}</td>
                  <td>{{el.observacion}}</td>
                  <td>{{el.fecha_modificacion | date: 'dd/MM/yyyy HH:mm:ss'}}</td>
                </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      <!-- Observaciones -->
      <br>
      <div class="row">
        <div class="col-md-6 col-lg-4">
          <ng-container>
            <div class="form-group">
              <label>Estado del elemento:</label><br>
              <mat-checkbox class="active" color="primary"
                            (change)="changeCheck();"
                            [checked]="checkedEstatus"
                            [disabled]="deshabiliarEstatus">
                <mat-label>Activo</mat-label>
              </mat-checkbox>
            </div>
          </ng-container>
        </div>
        <!--
        <div class="col-md-6 col-lg-4">
          <ng-container>
            <div class="form-group">
              <label>Evidencia:</label><br>
              <input type="file">
            </div>
          </ng-container>
        </div>-->
      </div>
    </div>
  </form>
</div>
