<div class="row">
	<mdb-breadcrumb customClass="white" class="w-100">
		<mdb-breadcrumb-item class="">
			<mdb-icon fas icon="cog"></mdb-icon>
		</mdb-breadcrumb-item>
		<mdb-breadcrumb-item>PPA</mdb-breadcrumb-item>
		<mdb-breadcrumb-item>{{ "Data Mining" | translate }}</mdb-breadcrumb-item>
		<mdb-breadcrumb-item class="active">{{ "Monitoring station" | translate }}</mdb-breadcrumb-item>
	</mdb-breadcrumb>
</div>

<div class="section">
	<div class="row pb-2">
		<div class="col">
			<p class="section_titulo_0">{{ "Importa Variables de Estación de Supervisión" | translate }}</p>
			<p class="section_subtitulo_0"></p>
		</div>
	</div>
	<form [formGroup]="fileUploadForm" (ngSubmit)="upload(fileUploadForm.value)">
		<div class="row">
			
			<div class="col-12 col-sm-12 col-md-2">
				<div class="form-group">
					<label class="form-text">Fecha de operación Comercial:</label>
					<mat-form-field class="form-control">
						<input matInput [matDatepicker]="dp" [formControl]="date"
							/>
						<mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
						<mat-datepicker #dp
										startView="multi-year"
										(yearSelected)="chosenYearHandler($event)"
										(monthSelected)="chosenMonthHandler($event, dp)"
										panelClass="example-month-picker"></mat-datepicker>
					</mat-form-field>
				</div>
			</div>
			<div class="col-12 col-sm-12 col-md-2">
				<label class="form-text">Fuente:</label>
				<select formControlName="typeVarhtml" class="browser-default custom-select" [(ngModel)]="typeVarhtml">
					<option [value]="1">FileZilla FTP</option>
					<option [value]="2">PAYSERVER DB</option>
					<option [value]="3">PI SERVER DB</option>
					<option [value]="4">Manual</option>
				</select>
			</div>
			<div class="col-12 col-md-2 d-flex">
				<button class="btn align-self-center" style="margin: auto;" (click)="ejecutaProceso()">
					Carga
				</button>
			</div>
			<div class="col-12 col-md-6">
				<div class="row justify-content-end">
					<div class="col-12 col-sm-12 col-md-auto">
						Carga Archivo:<br />
						<app-file-upload formControlName="file" [progress]="progress"></app-file-upload>
						<mat-error
							*ngIf="!fileUploadForm.controls['file'].valid && fileUploadForm.controls['file'].touched">
							Requerido
						</mat-error>
					</div>
					<div class="col-12 col-sm-12 col-md-auto">
						<button type="button" class="btn" (click)="download()" style="width: 175px;">
							<i class="ti-cloud-down"></i>
							{{ "Download" | translate }} {{ "Layout" | translate }}
						</button>
						<br />
						<button type="submit" class="btn" [disabled]="!fileUploadForm.valid" style="width: 175px;">
							<i class="ti-cloud-up"></i>
							{{ "Import" | translate }}
						</button>
					</div>
				</div>
			</div>
		</div>
	</form>



	<!-- Tabla de Catalogos -->
	<div class="row mt-4 mb-4">
		<div class="col">
			<div class="mat-elevation-z0">
				<table matSort (matSortChange)="sortData($event)" mat-table [dataSource]="dataSource"
					class="table_catalogo" matSortActive="name" matSortDirection="asc" matSortDisableClear>
					<ng-container [matColumnDef]="column.key" *ngFor="let column of displayedColumnsOrder">
						<th mat-header-cell *matHeaderCellDef mat-sort-header> {{column.label | translate}} </th>
						<td mat-cell *matCellDef="let element">{{element[column.key]}}</td>

					</ng-container>

					<ng-container [matColumnDef]="column.key" *ngFor="let column of displayedColumnsActions">
						<th mat-header-cell *matHeaderCellDef> {{column.label | translate}}</th>
						<td mat-cell *matCellDef="let element" [ngSwitch]="column.key">
							<a (click)="action(2, element.id)" *ngSwitchCase="'sys_see'">
								<img src="assets/images/skins/ico_Ver.png" alt="Visualizar">
							</a>
							<a (click)="action(3, element.id)" *ngSwitchCase="'sys_edit'">
								<img src="assets/images/skins/ico_Editar.png" alt="Editar">
							</a>
							<a (click)="eliminarRegistro(element.element)" *ngSwitchCase="'sys_delete'">
								<img src="assets/images/skins/ico_Borrar.png" alt="Eliminar">
							</a>
						</td>
					</ng-container>

					<tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
					<tr mat-row *matRowDef="let row; columns: columnsToDisplay;"></tr>
				</table>
				<mat-paginator [pageSizeOptions]="row_x_page" showFirstLastButtons></mat-paginator>
			</div>
		</div>
	</div>
	<!-- ./Tabla de Catalogos -->

	<hr />

	<div class="row pb-2">
		<div class="col">
			<p class="section_titulo_0">Consulta Variables</p>
			<p class="section_subtitulo_0"></p>
		</div>
	</div>
	<form [formGroup]="filterDatesFormGroup" (ngSubmit)="searchTagsFromTo()">
		<div class="row mb-3 mt-3">
			<div class="col">
				<div class="form-group">
					<label class="form-text" for="dateInihtml">Tags:</label>
					<mat-form-field class="form-control">
						<mat-select [formControl]="tags" multiple>
							<mat-option *ngFor="let tag of tagsList" [value]="tag">{{ tag }}</mat-option>
						</mat-select>
					</mat-form-field>
				</div>
			</div>
			<!--div class="col">
				<div class="form-group">
					<label class="form-text" for="dateInihtml">De:</label>
					<mat-form-field class="form-control">
						<input matInput [matDatepicker]="dateInihtml" [(ngModel)]="dateIni"
							[ngModelOptions]="{ standalone: true }" (dateChange)="dateChangeIni($event)" />
						<mat-datepicker-toggle matSuffix [for]="dateInihtml"></mat-datepicker-toggle>
						<mat-datepicker #dateInihtml></mat-datepicker>
					</mat-form-field>
				</div>
			</div>
			<div class="col">
				<div class="form-group">
					<label class="form-text" for="dateFinhtml"> Al:</label>
					<mat-form-field class="form-control">
						<input matInput [min]="dateIni" [matDatepicker]="dateFinhtml" [(ngModel)]="dateFin"
							[ngModelOptions]="{ standalone: true }" (dateChange)="dateChangeFin($event)" />
						<mat-datepicker-toggle matSuffix [for]="dateFinhtml"></mat-datepicker-toggle>
						<mat-datepicker #dateFinhtml></mat-datepicker>
					</mat-form-field>
				</div>
			</div-->
			<div class="col d-flex align-middle">
				<button class="btn align-self-end" style="margin: auto;">
					<mdb-icon far icon="save" class="mr-1"></mdb-icon> Graficar
				</button>
				<button type='button align-self-end' class="btn" style="margin: auto;">
					<i class="ti-cloud-down"></i> {{'Download' | translate}} {{'XLS' | translate}}
				</button>
			</div>
		</div>
	</form>

	<div class="row">
		<div class="col">
			<div #chartLineMs></div>
		</div>
	</div>
</div>
