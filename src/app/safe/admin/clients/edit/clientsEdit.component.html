<div class="p-5">
  <!-- Titulo -->
  <div class=" row">
    <div class="col">
      <span class="agila-cda-titulo">{{getTitle()}}</span>
    </div>
  </div>
  <!--Botones-->
  <form [formGroup]="clientForm" (ngSubmit)="save(clientForm.value)">
    <div class="row mt-5 mb-5">
      <div class="col">
        <button type="submit" class="btn right" [disabled]="!clientForm.valid"
          [ngClass]="{'blue': globalService.aguila,'orange': !globalService.aguila}">
          Guardar Cliente
        </button>
      </div>
    </div>
    <!-- Inputs -->
    <ng-container *ngFor="let formControl of formControls">
      <div class="row">
        <div class="col dividerSection" [ngClass]="{'blue': globalService.aguila,'orange': !globalService.aguila}">
          <b>{{formControl.section}}</b>
        </div>
      </div>
      <div class="row">
        <ng-container *ngFor="let in of formControl.inputs">
          <ng-container [ngSwitch]="in.inputtype">
            <input *ngSwitchCase="'hidden'" type="hidden" value="{{in.label}}" name="{{in.label}}">
            <ng-container *ngSwitchCase="'text'">
              <div class="col-md-auto col-md-6 col-lg-4">
                <div class="row">
                  <div class="col-md-{{in.col || 8}}">
                    <mat-form-field class="full-width">
                      <input matInput formControlName="{{in.formControlName}}" placeholder="{{in.label}}">
                    </mat-form-field>
                  </div>
                  <div class="col-md-4">
                    <mat-error *ngIf="!clientForm.controls[in.formControlName].valid 
                      && clientForm.controls[in.formControlName].touched">
                      Requerido
                    </mat-error>
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngSwitchCase="'time'">
              <div class="col-md-auto col-md-6 col-lg-4">
                <div class="row">
                  <div class="col-md-{{in.col || 8}}">
                    <mat-form-field class="full-width">
                      <input type="time" matInput formControlName="{{in.formControlName}}" placeholder="{{in.label}}">
                    </mat-form-field>
                  </div>
                  <div class="col-md-4">
                    <mat-error *ngIf="!clientForm.controls[in.formControlName].valid 
                      && clientForm.controls[in.formControlName].touched">
                      Requerido
                    </mat-error>
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngSwitchCase="'select'">
              <div class="col-md-auto col-md-6 col-lg-4">
                <div class="row">
                  <div class="col-md-{{in.col || 8}}">
                    <mat-form-field class="full-width">
                      <mat-label>{{in.label}}</mat-label>
                      <mat-select formControlName="{{in.formControlName}}"
                        (selectionChange)="onSelect($event.value, in)">
                        <mat-option *ngFor="let option of in.options" [value]="option">
                          {{option.description != null ? option.description: option.name}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                  <div class="col-md-4">
                    <mat-error *ngIf="!clientForm.controls[in.formControlName].valid 
                      && clientForm.controls[in.formControlName].touched">
                      Requerido
                    </mat-error>
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngSwitchCase="'checkbox'">
              <div class="col-md-auto col-md-6 col-lg-4">
                <div class="row">
                  <div class="col-md-{{in.col || 8}}">
                    <mat-checkbox class="active" color="primary" formControlName="{{in.formControlName}}">
                      <mat-label>{{in.label}}</mat-label>
                    </mat-checkbox>
                  </div>
                  <div class="col-md-4">
                    <mat-error *ngIf="!clientForm.controls[in.formControlName].valid 
                      && clientForm.controls[in.formControlName].touched">
                      Requerido
                    </mat-error>
                  </div>
                </div>
              </div>
            </ng-container>
            <ng-container *ngSwitchCase="'textarea'">
              <div class="col-md-auto col-md-6 col-lg-4">
                <div class="row">
                  <div class="col-md-{{in.col || 12}}">
                    <mat-form-field class="full-width">
                      <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize"
                        formControlName="{{in.formControlName}}" placeholder="{{in.label}}"></textarea>
                    </mat-form-field>
                    <div class="col-md-4">
                      <mat-error *ngIf="!contactForm.controls[in.formControlName].valid 
                              && contactForm.controls[in.formControlName].touched">
                        Requerido
                      </mat-error>
                    </div>
                  </div>
                </div>
              </div>
            </ng-container>
          </ng-container>
        </ng-container>
      </div>
    </ng-container>
  </form>
  <!-- CUENTAS DEL CLIENTE -->
  <form [formGroup]="accountForm" (ngSubmit)="saveAccount(accountForm.value)">
    <div class="row">
      <div class="col dividerSection" [ngClass]="{'blue': globalService.aguila,'orange': !globalService.aguila}">
        <b>Cuentas de Cliente</b>
      </div>
    </div>
    <div class="row">
      <ng-container *ngFor="let in of formControlsAccount">
        <ng-container [ngSwitch]="in.inputtype">
          <ng-container *ngSwitchCase="'text'">
            <div class="col-md-auto col-md-6 col-lg-4">
              <div class="row">
                <div class="col-md-{{in.col || 8}}">
                  <mat-form-field class="full-width">
                    <input matInput formControlName="{{in.formControlName}}" placeholder="{{in.label}}">
                  </mat-form-field>
                </div>
                <div class="col-md-4">
                  <mat-error *ngIf="!accountForm.controls[in.formControlName].valid 
                        && accountForm.controls[in.formControlName].touched">
                    Requerido
                  </mat-error>
                </div>
              </div>
            </div>
          </ng-container>
          <ng-container *ngSwitchCase="'select'">
            <div class="col-md-auto col-md-6 col-lg-4">
              <div class="row">
                <div class="col-md-{{in.col || 8}}">
                  <mat-form-field class="full-width">
                    <mat-label>{{in.label}}</mat-label>
                    <mat-select formControlName="{{in.formControlName}}" (selectionChange)="onSelect($event.value, in)">
                      <mat-option *ngFor="let option of in.options" [value]="option">
                        {{option.description != null ? option.description: option.name}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col-md-4">
                  <mat-error *ngIf="!accountForm.controls[in.formControlName].valid 
                        && accountForm.controls[in.formControlName].touched">
                    Requerido
                  </mat-error>
                </div>
              </div>
            </div>
          </ng-container>
        </ng-container>
      </ng-container>
    </div>
    <div class="col">
      <button type="button" class="btn right" (click)="cancelAccount()"
        [ngClass]="{'blue': globalService.aguila,'orange': !globalService.aguila}">
        Cancelar
      </button>
      <button type="submit" class="btn right" [disabled]="!accountForm.valid"
        [ngClass]="{'blue': globalService.aguila,'orange': !globalService.aguila}">
        Agregar
      </button>
    </div>
  </form>

  <div class="table-container mat-elevation-z8">
    <table matSort mat-table [dataSource]="accountsDataSource">
      <ng-container matColumnDef="bank">
        <th mat-header-cell *matHeaderCellDef>Banco </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.bank.description != null 
            ? element.bank.description: element.bank.name}}
        </td>
      </ng-container>
      <ng-container matColumnDef="branchOffice">
        <th mat-header-cell *matHeaderCellDef>Sucursal </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.branchOffice}}
        </td>
      </ng-container>
      <ng-container matColumnDef="account">
        <th mat-header-cell *matHeaderCellDef>Cuenta </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.account}}
        </td>
      </ng-container>
      <ng-container matColumnDef="clabe">
        <th mat-header-cell *matHeaderCellDef>Clabe </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.clabe}}
        </td>
      </ng-container>
      <ng-container matColumnDef="reference">
        <th mat-header-cell *matHeaderCellDef>Referencia </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.reference}}
        </td>
      </ng-container>
      <ng-container matColumnDef="edit">
        <th mat-header-cell *matHeaderCellDef> Editar </th>
        <td mat-cell *matCellDef="let element;" class="p-2 border-none">
          <a (click)="editAccount(element)" *ngIf="!entity.readOnly">
            <img src="assets/images/skins/ico_Editar.png" alt="Visualizar">
          </a>
        </td>
      </ng-container>
      <ng-container matColumnDef="rm">
        <th mat-header-cell *matHeaderCellDef> Eliminar </th>
        <td mat-cell *matCellDef="let element; let i = index;" class="p-2 border-none">
          <i class="fas fa-trash-alt" (click)="deleteAccount(i)" *ngIf="!entity.readOnly"></i>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="accountsColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: accountsColumns;"></tr>
    </table>

    <mat-paginator [pageSizeOptions]="[50,100,250,500]" showFirstLastButtons></mat-paginator>
  </div>

  <!-- CONTACTOS DEL CLIENTE -->
  <form [formGroup]="contactForm" (ngSubmit)="saveContact(contactForm.value)">
    <div class="row">
      <div class="col dividerSection" [ngClass]="{'blue': globalService.aguila,'orange': !globalService.aguila}">
        <b>Contactos de Cliente</b>
      </div>
    </div>
    <div class="row">
      <ng-container *ngFor="let in of formControlsContact">
        <ng-container [ngSwitch]="in.inputtype">
          <ng-container *ngSwitchCase="'text'">
            <div class="col-md-auto col-md-6 col-lg-4">
              <div class="row">
                <div class="col-md-{{in.col || 8}}">
                  <mat-form-field class="full-width">
                    <input matInput formControlName="{{in.formControlName}}" placeholder="{{in.label}}">
                  </mat-form-field>
                </div>
                <div class="col-md-4">
                  <mat-error *ngIf="!contactForm.controls[in.formControlName].valid 
                            && contactForm.controls[in.formControlName].touched">
                    Requerido
                  </mat-error>
                </div>
              </div>
            </div>
          </ng-container>
          <ng-container *ngSwitchCase="'textarea'">
            <div class="col-md-auto col-md-6 col-lg-4">
              <div class="row">
                <div class="col-md-{{in.col || 12}}">
                  <mat-form-field class="full-width">
                    <textarea matInput cdkTextareaAutosize #autosize="cdkTextareaAutosize"
                      formControlName="{{in.formControlName}}" placeholder="{{in.label}}"></textarea>
                  </mat-form-field>
                  <div class="col-md-4">
                    <mat-error *ngIf="!contactForm.controls[in.formControlName].valid 
                                  && contactForm.controls[in.formControlName].touched">
                      Requerido
                    </mat-error>
                  </div>
                </div>
              </div>
            </div>
          </ng-container>

        </ng-container>
      </ng-container>
    </div>
    <div class="col">
      <button type="button" class="btn right" (click)="cancelContact()"
        [ngClass]="{'blue': globalService.aguila,'orange': !globalService.aguila}">
        Cancelar
      </button>
      <button type="submit" class="btn right" [disabled]="!contactForm.valid"
        [ngClass]="{'blue': globalService.aguila,'orange': !globalService.aguila}">
        Agregar
      </button>
    </div>
  </form>
  <div class="table-container mat-elevation-z8">
    <table matSort mat-table [dataSource]="contactsDatasource">
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>Nombre </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.name}}
        </td>
      </ng-container>
      <ng-container matColumnDef="lastName">
        <th mat-header-cell *matHeaderCellDef>Apellido Paterno </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.lastName}}
        </td>
      </ng-container>
      <ng-container matColumnDef="maidenName">
        <th mat-header-cell *matHeaderCellDef>Apellido Materno </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.maidenName}}
        </td>
      </ng-container>
      <ng-container matColumnDef="email">
        <th mat-header-cell *matHeaderCellDef>Email </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.email}}
        </td>
      </ng-container>
      <ng-container matColumnDef="phone">
        <th mat-header-cell *matHeaderCellDef>Teléfono </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.phone}}
        </td>
      </ng-container>
      <ng-container matColumnDef="movilPhone">
        <th mat-header-cell *matHeaderCellDef>Teleono Móvil </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.movilPhone}}
        </td>
      </ng-container>
      <ng-container matColumnDef="position">
        <th mat-header-cell *matHeaderCellDef>Posición </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.position}}
        </td>
      </ng-container>
      <ng-container matColumnDef="title">
        <th mat-header-cell *matHeaderCellDef>Título </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.title}}
        </td>
      </ng-container>
      <ng-container matColumnDef="observations">
        <th mat-header-cell *matHeaderCellDef>Observaciones </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.observations}}
        </td>
      </ng-container>
      <ng-container matColumnDef="edit">
        <th mat-header-cell *matHeaderCellDef> Editar </th>
        <td mat-cell *matCellDef="let element;" class="p-2 border-none">
          <a (click)="editContact(element)" *ngIf="!entity.readOnly">
            <img src="assets/images/skins/ico_Editar.png" alt="Visualizar">
          </a>
        </td>
      </ng-container>
      <!-- Eliminar Column -->
      <ng-container matColumnDef="rm">
        <th mat-header-cell *matHeaderCellDef> Eliminar </th>
        <td mat-cell *matCellDef="let element; let i = index;" class="p-2 border-none">
          <i class="fas fa-trash-alt" (click)="deleteContact(i)" *ngIf="!entity.readOnly"></i>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="contactsColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: contactsColumns;"></tr>
    </table>

    <mat-paginator [pageSizeOptions]="[50,100,250,500]" showFirstLastButtons></mat-paginator>
  </div>
  <!-- CÓDIGOS PARA ADDENDA PRODUCTOS DEL CLIENTE -->
  <form [formGroup]="productForm" (ngSubmit)="saveProduct(productForm.value)">
    <div class="row">
      <div class="col dividerSection" [ngClass]="{'blue': globalService.aguila,'orange': !globalService.aguila}">
        <b> Códigos para Addenda Productos del Cliente </b>
      </div>
    </div>
    <div class="row">
      <ng-container *ngFor="let in of formControlsProduct">
        <ng-container [ngSwitch]="in.inputtype">
          <ng-container *ngSwitchCase="'text'">
            <div class="col-md-auto col-md-6 col-lg-4">
              <div class="row">
                <div class="col-md-{{in.col || 8}}">
                  <mat-form-field class="full-width">
                    <input matInput formControlName="{{in.formControlName}}" placeholder="{{in.label}}">
                  </mat-form-field>
                </div>
                <div class="col-md-4">
                  <mat-error *ngIf="!productForm.controls[in.formControlName].valid 
                                && productForm.controls[in.formControlName].touched">
                    Requerido
                  </mat-error>
                </div>
              </div>
            </div>
          </ng-container>
          <ng-container *ngSwitchCase="'select'">
            <div class="col-md-auto col-md-6 col-lg-4">
              <div class="row">
                <div class="col-md-{{in.col || 8}}">
                  <mat-form-field class="full-width">
                    <mat-label>{{in.label}}</mat-label>
                    <mat-select formControlName="{{in.formControlName}}">
                      <mat-option *ngFor="let option of in.options" [value]="option">
                        {{option.description != null ? option.description: option.name}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                </div>
                <div class="col-md-4">
                  <mat-error *ngIf="!productForm.controls[in.formControlName].valid 
                      && productForm.controls[in.formControlName].touched">
                    Requerido
                  </mat-error>
                </div>
              </div>
            </div>
          </ng-container>
          <ng-container *ngSwitchCase="'checkbox'">
            <div class="col-md-auto col-md-6 col-lg-4">
              <div class="row">
                <div class="col-md-{{in.col || 8}}">
                  <mat-checkbox class="active" color="primary" formControlName="{{in.formControlName}}">
                    <mat-label>{{in.label}}</mat-label>
                  </mat-checkbox>
                </div>
                <div class="col-md-4">
                  <mat-error *ngIf="!productForm.controls[in.formControlName].valid 
                        && productForm.controls[in.formControlName].touched">
                    Requerido
                  </mat-error>
                </div>
              </div>
            </div>
          </ng-container>
        </ng-container>

      </ng-container>
    </div>
    <div class="col">
      <button type="button" class="btn right" (click)="cancelProduct()"
        [ngClass]="{'blue': globalService.aguila,'orange': !globalService.aguila}">
        Cancelar
      </button>
      <button type="submit" class="btn right" [disabled]="!productForm.valid"
        [ngClass]="{'blue': globalService.aguila,'orange': !globalService.aguila}">
        Agregar
      </button>
    </div>
  </form>
  <div class="table-container mat-elevation-z8">
    <table matSort mat-table [dataSource]="productsDatasource">
      <ng-container matColumnDef="product">
        <th mat-header-cell *matHeaderCellDef>Servicio </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.product.name}}
        </td>
      </ng-container>
      <ng-container matColumnDef="code">
        <th mat-header-cell *matHeaderCellDef>Código de Cliente </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.code}}
        </td>
      </ng-container>
      <ng-container matColumnDef="active">
        <th mat-header-cell *matHeaderCellDef>Activo </th>
        <td mat-cell *matCellDef="let element" class="p-2 border-none">
          {{element.active ? 'Activado': 'Desactivado'}}
        </td>
      </ng-container>

      <ng-container matColumnDef="edit">
          <th mat-header-cell *matHeaderCellDef> Editar </th>
          <td mat-cell *matCellDef="let element;" class="p-2 border-none">
            <a (click)="editProduct(element)" *ngIf="!entity.readOnly">
              <img src="assets/images/skins/ico_Editar.png" alt="Visualizar">
            </a>
          </td>
      </ng-container>

      <!-- Eliminar Column -->
      <ng-container matColumnDef="rm">
        <th mat-header-cell *matHeaderCellDef> Eliminar </th>
        <td mat-cell *matCellDef="let element; let i = index;" class="p-2 border-none">
          <i class="fas fa-trash-alt" (click)="deleteProduct(i)" *ngIf="!entity.readOnly"></i>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="productsColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: productsColumns;"></tr>
    </table>

    <mat-paginator [pageSizeOptions]="[50,100,250,500]" showFirstLastButtons></mat-paginator>
  </div>
</div>